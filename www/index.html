<!DOCTYPE HTML>
<html>
<head> <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <title></title>

<!-- script src="http://192.168.1.4/target/target-script-min.js#painrate130912"></script -->
<script>


   // Call onDeviceReady when Cordova is loaded.
    //
    // At this point, the document has loaded but cordova-1.7.0.js has not.
    // When Cordova is loaded and talking with the native device,
    // it will call the event `deviceready`.
    //
    function onLoad() {
        document.addEventListener("deviceready", onDeviceReady, false);
        
	//var elementday = document.getElementById('dayinfo');
        var d = new Date();
        //elementday.innerHTML = 'day of the week = ' + d.getDay();
	if (d.getDay() == 1) { //monday show the last questionisible
	     document.getElementById('onmonday').style.display = 'block';
		}
	else {
             document.getElementById('onmonday').style.display = 'none';
	}
    }

    // Cordova is ready
    //
    function onDeviceReady() {
        var element = document.getElementById('deviceProperties');

      

        element.innerHTML = 'Device Name: '     + device.name     + '<br />' + 
                            'Device Cordova: '  + device.cordova + '<br />' + 
                            'Device Platform: ' + device.platform + '<br />' + 
                            'Device UUID: '     + device.uuid     + '<br />' + 
                            'Device Version: '  + device.version  + '<br />';


       
 
    // localStorage.setItem('devicename', JSON.stringify(device.name));
    //var deviceuuid = JSON.stringify(device.uuid); 
    //var devicename = JSON.stringify(device.name);

     //localStorage.setItem('deviceuuid', JSON.stringify(device.uuid));
     //alert (deviceuuid);
     //alert(device.uuid); 
     //alert(device.name);
     //console.log(device.name);
      //$.mobile.changePage("#two");  
    }


   

    </script>
   
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
	<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
	
	
 <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />

</head>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script src="http://documentcloud.github.com/underscore/underscore-min.js"></script>
<script src="http://documentcloud.github.com/backbone/backbone-min.js"></script>

<script>

  
   
   
  
  
   $(function() {
   
  
   $('form').submit(function(){
       console.log('inside submit function');
       var d = new Date();
       var curr_date = d.getDate();
       var curr_month = d.getMonth() + 1; //Months are zero based
       var curr_year = d.getFullYear();
       var datestring = curr_date + "-" + curr_month + "-" + curr_year;
    
       var timestring = d.getHours() + ":"  
                + d.getMinutes() + ":" 
                + d.getSeconds();   //timestamp shows time of submit!

       if (d.getDay() != 1){ //!monday, set val to -1. 
	 $("#slider-4").val() = -1; 
         alert('not monday!');
	}

       var agedata = {'date': datestring, 'time': timestring, 'painrate':$("#slider-2").val(), 'qolrate':$("#slider-3").val(), 'toggle':$("#flip-3").val(), 'toggle2':$("#flip-4").val(), 'uuid': device.uuid, 'name': device.name, 'weekrate': $("#slider-4").val()};
       var json_text = JSON.stringify(agedata);

     
     

       alert(json_text);
    
       $.ajax({
           type: 'post',
           data:json_text,
           contentType: 'application/json; charset=utf-8',
           dataType: 'json',
           //async: false,
           //cache: false,
           url: 'http://solutionlibre.com/britta/paindata_pg.php',
           success: function(response){
              
              alert('Thank you for your input.'+ response);
           },
           error: function(data, textStatus, errorThrown) { 
           // XMLHttpRequest, textStatus, errorThrown) { 
              alert("Status: " + textStatus + errorThrown); 
              console.log("agedata=", agedata);
              console.log(agedata);
             
           }
       });

   return false;
   });
});

  </script>

<body onload="onLoad()">
  

<div data-role="page" id="one">
   <div data-role="header">
        <h1>Pain Rating</h1>
	</div><!-- /header -->
	
   <div data-role="content">
       <div class="app" style="display:none;">
         <div id="deviceready" class="blink">
                <p class="event listening">Connecting to Device</p>
                <p class="event received">Device is Ready</p>
                </div>
         <p id="deviceProperties">Loading device properties...</p> 
         </div>
 
       <script type="text/javascript" src="phonegap.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript">
            app.initialize();
        </script>

<!-- p><a href="#two" data-role="button">Pain Rating</a></p>

 

   </div><!-- /content ->       
</div><!-- /page one -> 




<div data-role="page" id="two">
<div data-role="header">
		<h1>Pain Rating</h1>
	</div>
<div data-role="content" >	
		<h2>TWO</h2>
--><p>

<div data-role="fieldcontain">
	<label for="slider-3">Rate your Current Pain Level:</label>
	<input type="range" name="slider-2" id="slider-2" value="5" min="0" max="10" step="1" data-theme="a" data-track-theme="b" />
</div>
<hr>

<div data-role="fieldcontain">
	<label for="slider-3">Rate your Current Quality of Life:</label>
	<input type="range" name="slider-3" id="slider-3" value="5" min="0" max="10" step="1" data-theme="a" data-track-theme="b" />
</div>
<hr>

<div data-role="fieldcontain">
	<label for="flip-3">Have you taken Today's Medications?</label>
	<select name="flip-3" id="flip-3" data-role="slider" data-theme="a">
		<option value="no">No</option>
		<option value="yes">Yes</option>
	</select>
</div> 
<div data-role="fieldcontain">
	<label for="flip-4">Taken any Additional Pain Medications?</label>
	<select name="flip-4" id="flip-4" data-role="slider" data-theme="a">
		<option value="no">No</option>
		<option value="yes">Yes</option>
	</select> 
</div>


<div id="dayinfo"></div>



  <div id="onmonday" data-role="fieldcontain">
	<label for="slider-4">Rate your General Quality of Life during the Past Week:</label>
	<input type="range" name="slider-4" id="slider-4" value="5" min="0" max="10" step="1" data-theme="a" data-track-theme="b" />
  </div>


<div id="submitform"  data-landmark-id="1"><form><input type="submit" value="Submit"></form></div>




  </div><!-- /content -->       
</div><!-- /page  --> 



</body>
</html>
